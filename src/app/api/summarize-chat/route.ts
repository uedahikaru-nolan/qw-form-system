import { NextRequest, NextResponse } from 'next/server'
import OpenAI from 'openai'
import { ChatMessage } from '@/types'

const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY,
})

export async function POST(request: NextRequest) {
  try {
    // APIã‚­ãƒ¼ã®å­˜åœ¨ç¢ºèª
    if (!process.env.OPENAI_API_KEY) {
      console.error('OPENAI_API_KEY is not set')
      return NextResponse.json(
        { error: 'OpenAI API key is not configured' },
        { status: 500 }
      )
    }
    
    const { chatHistory, siteType, industry } = await request.json()
    
    const systemPrompt = `ã‚ãªãŸã¯ä¼šè©±å†…å®¹ã‚’è¦ç´„ãƒ»æ•´ç†ã™ã‚‹å°‚é–€å®¶ã§ã™ã€‚
ä»¥ä¸‹ã®ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‹ã‚‰ã€${industry}ã®${siteType}ä½œæˆã«é–¢ã™ã‚‹é‡è¦ãªæƒ…å ±ã‚’æ•´ç†ã—ã¦ãã ã•ã„ã€‚

ä»¥ä¸‹ã®å½¢å¼ã§æ•´ç†ã—ã¦ãã ã•ã„ï¼š

## ğŸ“‹ åé›†ã—ãŸæƒ…å ±ã®ã¾ã¨ã‚

### åŸºæœ¬æƒ…å ±
- æ˜ç¢ºã«æä¾›ã•ã‚ŒãŸæƒ…å ±ã‚’ç®‡æ¡æ›¸ãã§è¨˜è¼‰

### ä½œæˆäºˆå®šã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
- ã©ã®ã‚ˆã†ãªã‚µã‚¤ãƒˆã‚’ä½œæˆã™ã‚‹ã‹
- ä¸»è¦ãªç‰¹å¾´ã‚„å¼·ã¿
- ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆã‚ã‹ã‚‹å ´åˆï¼‰

### è¿½åŠ ã§å¿…è¦ãªæƒ…å ±
- ã¾ã åé›†ã•ã‚Œã¦ã„ãªã„é‡è¦ãªæƒ…å ±
- å¾Œã§è¿½åŠ ãƒ»ç·¨é›†ãŒæ¨å¥¨ã•ã‚Œã‚‹é …ç›®

## ğŸ—ï¸ ${siteType === 'HP' ? 'ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸' : siteType === 'LP' ? 'ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸' : siteType === 'PORTFOLIO' ? 'ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚µã‚¤ãƒˆ' : 'Webã‚·ã‚¹ãƒ†ãƒ '}æ§‹æˆã®ææ¡ˆ

### æ¨å¥¨ãƒšãƒ¼ã‚¸æ§‹æˆ

ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸæƒ…å ±ã‚’ã‚‚ã¨ã«ã€å„ãƒšãƒ¼ã‚¸ã®å…·ä½“çš„ãªã‚³ãƒ”ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆã‚’å«ã‚ã¦ææ¡ˆã—ã¦ãã ã•ã„ã€‚
${siteType === 'HP' ? `
- **ãƒ›ãƒ¼ãƒ ** - ç¬¬ä¸€å°è±¡ã‚’æ±ºã‚ã‚‹é‡è¦ãªãƒšãƒ¼ã‚¸
  - ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³
    - ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼: ã€Œï¼ˆãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‹ã‚‰æ¥­ç¨®ãƒ»ç‰¹å¾´ã‚’è¸ã¾ãˆãŸå°è±¡çš„ãªã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼ã‚’ç”Ÿæˆï¼‰ã€
    - ã‚µãƒ–ã‚³ãƒ”ãƒ¼: ã€Œï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ™ãƒãƒ•ã‚£ãƒƒãƒˆã‚’ç¤ºã™å…·ä½“çš„ãªã‚µãƒ–ã‚³ãƒ”ãƒ¼ï¼‰ã€
    - èª¬æ˜æ–‡: ï¼ˆ100-150æ–‡å­—ç¨‹åº¦ã§äº‹æ¥­ã®ç‰¹å¾´ã‚’èª¬æ˜ï¼‰
  - ã‚µãƒ¼ãƒ“ã‚¹/å•†å“ã®æ¦‚è¦
    - è¦‹å‡ºã—: ã€Œç§ãŸã¡ãŒã§ãã‚‹ã“ã¨ã€ã¾ãŸã¯æ¥­ç¨®ã«åˆã‚ã›ãŸè¦‹å‡ºã—
    - æœ¬æ–‡: ï¼ˆæä¾›ã‚µãƒ¼ãƒ“ã‚¹ã®ç‰¹å¾´ã‚’3ã¤ã®ãƒã‚¤ãƒ³ãƒˆã§èª¬æ˜ï¼‰
  - ãŠå®¢æ§˜ã®å£°ã‚„å®Ÿç¸¾
    - è¦‹å‡ºã—: ã€ŒãŠå®¢æ§˜ã‹ã‚‰ã®è©•ä¾¡ã€
    - å†…å®¹: ï¼ˆä¿¡é ¼æ€§ã‚’é«˜ã‚ã‚‹å®Ÿç¸¾ã‚„è©•ä¾¡ã‚’è¨˜è¼‰ï¼‰
  - CTAãƒœã‚¿ãƒ³
    - ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ: ã€Œç„¡æ–™ç›¸è«‡ã¯ã“ã¡ã‚‰ã€ã€Œä»Šã™ãå•ã„åˆã‚ã›ã‚‹ã€ãªã©

- **${industry}ã«ã¤ã„ã¦** - ä¿¡é ¼æ€§ã‚’é«˜ã‚ã‚‹ãƒšãƒ¼ã‚¸
  - äº‹æ¥­ç†å¿µãƒ»ã‚³ãƒ³ã‚»ãƒ—ãƒˆ
    - è¦‹å‡ºã—: ã€Œç§ãŸã¡ã®æƒ³ã„ã€
    - æœ¬æ–‡: ï¼ˆãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‹ã‚‰æŠ½å‡ºã—ãŸç†å¿µã‚„æƒ³ã„ã‚’200æ–‡å­—ç¨‹åº¦ã§ï¼‰
  - ç‰¹å¾´ãƒ»å¼·ã¿
    - è¦‹å‡ºã—: ã€Œé¸ã°ã‚Œã‚‹3ã¤ã®ç†ç”±ã€
    - å†…å®¹: ï¼ˆå…·ä½“çš„ãªå¼·ã¿ã‚’ç®‡æ¡æ›¸ãã§ï¼‰
  - ä»£è¡¨æŒ¨æ‹¶ã‚„ã‚¹ã‚¿ãƒƒãƒ•ç´¹ä»‹
    - è¦‹å‡ºã—: ã€Œä»£è¡¨ã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€
    - æœ¬æ–‡: ï¼ˆäººæŸ„ãŒä¼ã‚ã‚‹æ¸©ã‹ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰

- **ãƒ¡ãƒ‹ãƒ¥ãƒ¼/ã‚µãƒ¼ãƒ“ã‚¹** - è©³ç´°æƒ…å ±ãƒšãƒ¼ã‚¸
  - æä¾›ã‚µãƒ¼ãƒ“ã‚¹/å•†å“ã®è©³ç´°
    - å„ã‚µãƒ¼ãƒ“ã‚¹ã®èª¬æ˜æ–‡ã‚’å…·ä½“çš„ã«è¨˜è¼‰
  - æ–™é‡‘è¡¨ï¼ˆè©²å½“ã™ã‚‹å ´åˆï¼‰
    - åˆ†ã‹ã‚Šã‚„ã™ã„æ–™é‡‘ä½“ç³»ã®èª¬æ˜
  - ã‚ˆãã‚ã‚‹è³ªå•
    - æ¥­ç¨®ç‰¹æœ‰ã®FAQã‚’5-7å€‹ç¨‹åº¦

- **ãƒ–ãƒ­ã‚°/ãŠçŸ¥ã‚‰ã›** - æ›´æ–°æ€§ã®ã‚ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
  - æœ€æ–°æƒ…å ±ã®è¦‹å‡ºã—ä¾‹
  - ã‚«ãƒ†ã‚´ãƒªãƒ¼è¨­å®šã®ææ¡ˆ
  - æ›´æ–°é »åº¦ã®æ¨å¥¨

- **ã‚¢ã‚¯ã‚»ã‚¹/ãŠå•ã„åˆã‚ã›** - ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä¿ƒã™ãƒšãƒ¼ã‚¸
  - ã‚¢ã‚¯ã‚»ã‚¹æƒ…å ±ã®è¨˜è¼‰æ–¹æ³•
  - ãƒ•ã‚©ãƒ¼ãƒ ã®é …ç›®è¨­å®š
  - é›»è©±ç•ªå·ã®è¦‹ã›æ–¹
  - å–¶æ¥­æ™‚é–“ã®è¡¨ç¤ºæ–¹æ³•
` : siteType === 'LP' ? `
- **ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆãƒ“ãƒ¥ãƒ¼**
  - ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼: ã€Œï¼ˆãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‹ã‚‰æœ€ã‚‚ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã®ã‚ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆï¼‰ã€
  - ãƒ™ãƒãƒ•ã‚£ãƒƒãƒˆ: ã€Œï¼ˆé¡§å®¢ãŒå¾—ã‚‰ã‚Œã‚‹å…·ä½“çš„ãªä¾¡å€¤ã‚’3ã¤ç¨‹åº¦ï¼‰ã€
  - CTAãƒœã‚¿ãƒ³: ã€Œä»Šã™ãå§‹ã‚ã‚‹ã€ã€Œç„¡æ–™ã§è©¦ã™ã€ãªã©

- **èª²é¡Œæèµ·ã‚»ã‚¯ã‚·ãƒ§ãƒ³**
  - è¦‹å‡ºã—: ã€Œã“ã‚“ãªãŠæ‚©ã¿ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿã€
  - æ‚©ã¿ãƒªã‚¹ãƒˆ: ï¼ˆã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®å…·ä½“çš„ãªæ‚©ã¿3-5å€‹ï¼‰
  - å…±æ„Ÿãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ï¼ˆã€Œãã®æ°—æŒã¡ã€ã‚ˆãã‚ã‹ã‚Šã¾ã™ã€ãªã©ï¼‰

- **è§£æ±ºç­–ã®æç¤º**
  - è¦‹å‡ºã—: ã€Œï¼ˆå•†å“åï¼‰ãŒã‚ãªãŸã®æ‚©ã¿ã‚’è§£æ±ºã—ã¾ã™ã€
  - 3ã¤ã®ç‰¹å¾´: ï¼ˆå…·ä½“çš„ãªç‰¹å¾´ã¨ãã®ãƒ¡ãƒªãƒƒãƒˆï¼‰
  - ä»–ç¤¾ã¨ã®é•ã„: ï¼ˆç‹¬è‡ªã®å¼·ã¿ã‚’æ˜ç¢ºã«ï¼‰

- **å®Ÿç¸¾ãƒ»ãŠå®¢æ§˜ã®å£°**
  - æ•°å€¤å®Ÿç¸¾: ã€Œâ—‹â—‹%ã®æ–¹ãŒæº€è¶³ã€ãªã©
  - ãŠå®¢æ§˜ã®å£°: ï¼ˆå…·ä½“çš„ãªæˆåŠŸä½“é¨“è«‡2-3ä»¶ï¼‰
  - ãƒ“ãƒ•ã‚©ãƒ¼ã‚¢ãƒ•ã‚¿ãƒ¼: ï¼ˆè¦–è¦šçš„ã«åˆ†ã‹ã‚Šã‚„ã™ã„å¤‰åŒ–ï¼‰

- **æ–™é‡‘ãƒ»ç”³è¾¼ã¿ã‚»ã‚¯ã‚·ãƒ§ãƒ³**
  - ä¾¡æ ¼è¡¨ç¤º: ã€Œæœˆé¡â—‹â—‹å††ã‹ã‚‰ã€
  - ç‰¹åˆ¥ã‚ªãƒ•ã‚¡ãƒ¼: ã€Œä»Šã ã‘ã®ç‰¹å…¸ã€
  - CTAãƒœã‚¿ãƒ³: ã€Œç”³ã—è¾¼ã¿ã¯ã“ã¡ã‚‰ã€
` : siteType === 'PORTFOLIO' ? `
- **ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸**
  - ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼: ã€Œï¼ˆã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¨ã—ã¦ã®ä¸€ç•ªã®å¼·ã¿ã‚’è¡¨ç¾ï¼‰ã€
  - è‡ªå·±ç´¹ä»‹: ï¼ˆ100-150æ–‡å­—ã§çµŒé¨“ã¨å°‚é–€æ€§ã‚’ã‚¢ãƒ”ãƒ¼ãƒ«ï¼‰
  - ã‚¹ã‚­ãƒ«ã‚»ãƒƒãƒˆ: ï¼ˆä¸»è¦ã‚¹ã‚­ãƒ«ã‚’ç®‡æ¡æ›¸ãã§ï¼‰
  - ä»£è¡¨ä½œå“: ã€Œæœ€è¿‘ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ãªã©

- **ä½œå“ã‚®ãƒ£ãƒ©ãƒªãƒ¼**
  - ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«: ã€ŒWorksã€ã€Œåˆ¶ä½œå®Ÿç¸¾ã€ãªã©
  - ã‚«ãƒ†ã‚´ãƒªãƒ¼: ï¼ˆWebãƒ‡ã‚¶ã‚¤ãƒ³ã€ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã€ãã®ä»–ï¼‰
  - ä½œå“èª¬æ˜: ï¼ˆå„ä½œå“ã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆã¨å·¥å¤«ç‚¹ï¼‰

- **ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«**
  - è¦‹å‡ºã—: ã€ŒAbout Meã€ã€Œãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã€
  - çµŒæ­´: ï¼ˆæ™‚ç³»åˆ—ã§ä¸»è¦ãªçµŒé¨“ã‚’è¨˜è¼‰ï¼‰
  - å®Ÿç¸¾: ï¼ˆæ•°å€¤ã‚„å…·ä½“çš„ãªæˆæœï¼‰
  - å¼·ã¿: ï¼ˆä»–ã®ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ã¨ã®å·®åˆ¥åŒ–ãƒã‚¤ãƒ³ãƒˆï¼‰

- **ã‚³ãƒ³ã‚¿ã‚¯ãƒˆ**
  - è¦‹å‡ºã—: ã€ŒãŠä»•äº‹ã®ã”ä¾é ¼ã¯ã“ã¡ã‚‰ã€
  - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ã€ŒãŠæ°—è»½ã«ã”ç›¸è«‡ãã ã•ã„ã€
  - å¯¾å¿œå¯èƒ½ãªä»•äº‹: ï¼ˆå…·ä½“çš„ãªã‚µãƒ¼ãƒ“ã‚¹å†…å®¹ï¼‰
  - æ–™é‡‘ç›®å®‰: ã€Œâ—‹â—‹å††ã€œã€
` : `
- **ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**
  - ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ã€ŒãŠã‹ãˆã‚Šãªã•ã„ã€ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼‰ã•ã‚“ã€
  - ä¸»è¦æŒ‡æ¨™: ï¼ˆé‡è¦ãªKPIã‚’3-4å€‹è¡¨ç¤ºï¼‰
  - ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹: ï¼ˆã‚ˆãä½¿ã†æ©Ÿèƒ½ã¸ã®ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆï¼‰
  - ãŠçŸ¥ã‚‰ã›: ï¼ˆæœ€æ–°ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæƒ…å ±ï¼‰

- **ä¸»è¦æ©Ÿèƒ½ãƒšãƒ¼ã‚¸**
  - æ©Ÿèƒ½å: ï¼ˆãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‹ã‚‰æŠ½å‡ºã—ãŸä¸»è¦æ©Ÿèƒ½ï¼‰
  - æ©Ÿèƒ½èª¬æ˜: ï¼ˆå„æ©Ÿèƒ½ã®ä½¿ã„æ–¹ã¨ãƒ¡ãƒªãƒƒãƒˆï¼‰
  - æ“ä½œã‚¬ã‚¤ãƒ‰: ã€Œã‚¹ãƒ†ãƒƒãƒ—1: â—‹â—‹ã‚’ã‚¯ãƒªãƒƒã‚¯ã€ãªã©
  - ãƒ˜ãƒ«ãƒ—ãƒ†ã‚­ã‚¹ãƒˆ: ã€ŒãŠå›°ã‚Šã®æ™‚ã¯...ã€

- **è¨­å®šãƒ»ç®¡ç†**
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®š: ã€Œãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†ã€ã€Œé€šçŸ¥è¨­å®šã€ãªã©
  - ãƒ‡ãƒ¼ã‚¿ç®¡ç†: ã€Œã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€ã€Œãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã€æ©Ÿèƒ½
  - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: ã€Œãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ã€ã€ŒäºŒæ®µéšèªè¨¼ã€
`}

### ãƒ‡ã‚¶ã‚¤ãƒ³ã®æ–¹å‘æ€§
- åé›†ã—ãŸæƒ…å ±ã«åŸºã¥ã„ãŸå…·ä½“çš„ãªãƒ‡ã‚¶ã‚¤ãƒ³ææ¡ˆ
- ã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ ã€ãƒ•ã‚©ãƒ³ãƒˆã€ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®ææ¡ˆ
- ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã«éŸ¿ããƒ“ã‚¸ãƒ¥ã‚¢ãƒ«æˆ¦ç•¥

### SEOãƒ»ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°æˆ¦ç•¥
- åŠ¹æœçš„ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æˆ¦ç•¥
- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã®ææ¡ˆ
- SNSé€£æºã®æ´»ç”¨æ–¹æ³•

é‡è¦ï¼šæ¨å¥¨ãƒšãƒ¼ã‚¸æ§‹æˆã®ä¸­ã«ã€ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸæƒ…å ±ã‚’æ´»ç”¨ã—ã¦ã€å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®å…·ä½“çš„ãªã‚³ãƒ”ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆã‚’å«ã‚ã¦ãã ã•ã„ã€‚
èª­ã¿ã‚„ã™ãã€æ§‹é€ åŒ–ã•ã‚ŒãŸå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚`

    const chatContent = chatHistory.map((msg: ChatMessage) => 
      `${msg.role === 'user' ? 'ãƒ¦ãƒ¼ã‚¶ãƒ¼' : 'AI'}: ${msg.content}`
    ).join('\n\n')

    const completion = await openai.chat.completions.create({
      model: 'gpt-4o',
      messages: [
        {
          role: 'system',
          content: systemPrompt
        },
        {
          role: 'user',
          content: `ãƒãƒ£ãƒƒãƒˆå±¥æ­´:\n${chatContent}\n\nä¸Šè¨˜ã®ä¼šè©±ã‚’æ•´ç†ãƒ»è¦ç´„ã—ã¦ãã ã•ã„ã€‚`
        }
      ],
      temperature: 0.7,
      max_tokens: 3500,
    })

    const summary = completion.choices[0].message.content || ''
    
    return NextResponse.json({ summary })
  } catch (error: any) {
    console.error('Chat summarization error:', error)
    
    // ã‚¯ã‚©ãƒ¼ã‚¿ã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯ç‰¹åˆ¥ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    if (error?.code === 'insufficient_quota' || error?.error?.code === 'insufficient_quota') {
      return NextResponse.json(
        { error: 'APIä½¿ç”¨é‡ã®ä¸Šé™ã«é”ã—ã¾ã—ãŸã€‚' },
        { status: 500 }
      )
    }
    
    return NextResponse.json(
      { error: 'Failed to summarize chat' },
      { status: 500 }
    )
  }
}